@import "tailwindcss";

@theme inline {
  --color-bg-deep: #0d1117;
  --color-bg-card: #161b26;
  --color-bg-surface: #1e2636;
  --color-accent: #e8a020;
  --color-gold: #ffd700;
  --color-text-primary: #e8dcc8;
  --color-text-secondary: #c3d0e4;
  --color-success: #50c878;
  --color-danger: #e05050;
  --color-accent-dim: #e8a02033;
  --color-gold-dim: #ffd70033;
  --color-success-dim: #50c87833;
  --color-rpg-border: #c8a84e;
  --color-rpg-border-dim: #c8a84e44;
  --color-rpg-blue: #2a3a5c;
  --color-rpg-navy: #141c2e;
  --color-rpg-hp: #e05050;
  --color-rpg-mp: #5088e0;
  --font-sans: var(--font-adventure-body), "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
  --font-rpg-display: var(--font-adventure-display), var(--font-sans);
}

/* ダークRPGモード (デフォルト) */
:root {
  --color-bg-deep: #0d1117;
  --color-bg-card: #161b26;
  --color-bg-surface: #1e2636;
  --color-text-primary: #e8dcc8;
  --color-text-secondary: #c3d0e4;
  --color-accent-dim: #e8a02033;
  --color-gold-dim: #ffd70033;
  --color-success-dim: #50c87833;
  --color-rpg-border: #c8a84e;
  --color-rpg-border-dim: #c8a84e44;
  --adventure-bg: linear-gradient(170deg, #0d1117 0%, #141c2e 40%, #0d1520 70%, #0d1117 100%);
  --adventure-overlay:
    radial-gradient(ellipse at 20% 20%, rgba(60, 80, 140, 0.08) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 60%, rgba(200, 168, 78, 0.04) 0%, transparent 50%);
}

/* ライトモード - 羊皮紙 */
[data-theme="light"] {
  --color-bg-deep: #f0e8d8;
  --color-bg-card: #faf4e8;
  --color-bg-surface: #e8dcc8;
  --color-text-primary: #2a1f10;
  --color-text-secondary: #503a20;
  --color-accent-dim: #c8840022;
  --color-gold-dim: #c8a84e22;
  --color-success-dim: #40885022;
  --color-rpg-border: #a08030;
  --color-rpg-border-dim: #a0803044;
  --adventure-bg: linear-gradient(170deg, #f0e8d8 0%, #e8dcc8 40%, #f0e4d0 70%, #f0e8d8 100%);
  --adventure-overlay:
    radial-gradient(ellipse at 30% 30%, rgba(160, 128, 48, 0.06) 0%, transparent 50%),
    radial-gradient(ellipse at 70% 70%, rgba(100, 80, 40, 0.04) 0%, transparent 50%);
}

body {
  background: var(--adventure-bg);
  color: var(--color-text-primary);
  font-family: var(--font-sans);
  font-size: clamp(15px, 3.9vw, 17px);
  line-height: 1.55;
  font-weight: 500;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  min-height: 100vh;
  position: relative;
}

h1, h2, h3 {
  font-family: var(--font-rpg-display);
  letter-spacing: 0.04em;
}

body::before {
  content: '';
  position: fixed;
  inset: 0;
  background: var(--adventure-overlay);
  pointer-events: none;
  z-index: 0;
}

/* === RPG ウィンドウフレーム === */
.rpg-panel {
  background: var(--color-bg-card);
  border: 2px solid var(--color-rpg-border);
  border-radius: 4px;
  position: relative;
  box-shadow:
    inset 0 0 0 1px rgba(200, 168, 78, 0.15),
    0 4px 12px rgba(0, 0, 0, 0.4);
}

.rpg-panel::before {
  content: '';
  position: absolute;
  inset: 2px;
  border: 1px solid var(--color-rpg-border-dim);
  border-radius: 2px;
  pointer-events: none;
}

/* RPG パネルヘッダー（セクションタイトル用） */
.rpg-header {
  background: linear-gradient(180deg, var(--color-rpg-blue) 0%, var(--color-rpg-navy) 100%);
  border-bottom: 2px solid var(--color-rpg-border);
  padding: 6px 12px;
  margin: -2px -2px 0 -2px;
  border-radius: 2px 2px 0 0;
}

/* RPGスタイルのバー (HP/MP/XP) */
.rpg-bar {
  height: 14px;
  background: #0a0e18;
  border: 1px solid var(--color-rpg-border-dim);
  border-radius: 2px;
  overflow: hidden;
  position: relative;
}

.rpg-bar-fill {
  height: 100%;
  border-radius: 1px;
  transition: width 0.5s ease-out;
  position: relative;
}

.rpg-bar-fill::after {
  content: '';
  position: absolute;
  top: 1px;
  left: 2px;
  right: 2px;
  height: 4px;
  background: linear-gradient(180deg, rgba(255,255,255,0.35) 0%, transparent 100%);
  border-radius: 1px;
}

/* XPバー色 */
.rpg-bar-xp {
  background: linear-gradient(180deg, #f0c040 0%, #d09020 50%, #b07818 100%);
}

/* 覚悟ゲージ色 (ティア別) */
.rpg-bar-gray { background: linear-gradient(180deg, #888 0%, #555 100%); }
.rpg-bar-dim { background: linear-gradient(180deg, #e0a040 0%, #a07020 100%); opacity: 0.6; }
.rpg-bar-accent { background: linear-gradient(180deg, #f0c040 0%, #d09020 100%); }
.rpg-bar-gold { background: linear-gradient(180deg, #ffe060 0%, #d4a020 100%); }
.rpg-bar-gold-glow { background: linear-gradient(180deg, #ffe878 0%, #e8b830 100%); }

/* ピクセル風ドットセパレータ */
.rpg-dots::after {
  content: '···';
  letter-spacing: 3px;
  color: var(--color-rpg-border-dim);
}

/* RPGボタン */
.rpg-btn {
  background: linear-gradient(180deg, #3a4a6c 0%, #2a3650 50%, #1e2a40 100%);
  border: 2px solid var(--color-rpg-border);
  border-radius: 4px;
  color: var(--color-text-primary);
  font-family: var(--font-rpg-display);
  letter-spacing: 0.03em;
  font-weight: bold;
  position: relative;
  cursor: pointer;
  transition: all 0.15s;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

.rpg-btn:active {
  transform: scale(0.97);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
}

.rpg-btn::after {
  content: '';
  position: absolute;
  top: 2px;
  left: 4px;
  right: 4px;
  height: 1px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 1px;
}

.rpg-btn-primary {
  background: linear-gradient(180deg, #e0a030 0%, #c08020 50%, #a06818 100%);
  color: #1a1000;
  text-shadow: 0 1px 0 rgba(255, 255, 255, 0.2);
}

.rpg-btn-danger {
  background: linear-gradient(180deg, #c04040 0%, #a03030 50%, #802020 100%);
  color: #ffe0e0;
}

/* チェックマーク (RPG風) */
.rpg-check {
  width: 28px;
  height: 28px;
  border: 2px solid var(--color-rpg-border-dim);
  border-radius: 3px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: bold;
  background: #0a0e18;
  transition: all 0.15s;
}

.rpg-check-done {
  background: linear-gradient(135deg, #40a060 0%, #308050 100%);
  border-color: #50c878;
  color: #fff;
}

.rpg-check-auto {
  background: linear-gradient(135deg, #d4a020 0%, #b08818 100%);
  border-color: #ffd700;
  color: #1a1000;
}

/* ナビゲーション RPG風 */
.rpg-nav {
  background: linear-gradient(180deg, var(--color-bg-card) 0%, #0d1117 100%);
  border-top: 2px solid var(--color-rpg-border);
  box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.5);
}

.rpg-nav-item {
  position: relative;
  font-family: var(--font-rpg-display);
  transition: all 0.15s;
}

.rpg-nav-item-active::before {
  content: '';
  position: absolute;
  top: -2px;
  left: 25%;
  right: 25%;
  height: 2px;
  background: var(--color-accent);
  box-shadow: 0 0 8px var(--color-accent);
}

@media (max-width: 640px) {
  [class~="text-xs"] {
    font-size: 0.84rem;
    line-height: 1.2rem;
  }
}

/* ステータス値の装飾 */
.stat-value {
  text-shadow: 0 0 8px currentColor;
}

/* RPG モーダルオーバーレイ */
.rpg-modal-overlay {
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(4px);
}

.rpg-modal {
  background: var(--color-bg-card);
  border: 3px solid var(--color-rpg-border);
  border-radius: 4px;
  box-shadow:
    inset 0 0 0 1px rgba(200, 168, 78, 0.2),
    0 0 30px rgba(200, 168, 78, 0.15),
    0 8px 24px rgba(0, 0, 0, 0.6);
}

/* === アニメーション === */

@keyframes xp-fill {
  from { width: 0%; }
}

.xp-bar-animate {
  animation: xp-fill 0.6s ease-out;
}

@keyframes glow-pulse {
  0%, 100% { box-shadow: 0 0 8px var(--color-accent); }
  50% { box-shadow: 0 0 24px var(--color-accent), 0 0 48px var(--color-accent-dim); }
}

.glow-pulse {
  animation: glow-pulse 2s ease-in-out infinite;
}

@keyframes check-pop {
  0% { transform: scale(1); }
  50% { transform: scale(1.15); }
  100% { transform: scale(1); }
}

.check-pop {
  animation: check-pop 0.2s ease-out;
}

@keyframes fade-in {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

.modal-enter {
  animation: fade-in 0.3s ease-out;
}

/* テーマ切り替えトランジション */
body,
body * {
  transition: background-color 0.3s ease, color 0.2s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}

/* レベルアップ演出 */
@keyframes screen-flash {
  0% { opacity: 0.7; }
  100% { opacity: 0; }
}

@keyframes title-burst {
  0% { transform: scale(0); opacity: 0; }
  60% { transform: scale(1.3); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes anvil-strike {
  0% { transform: translateY(-60px) rotate(-15deg); opacity: 0; }
  50% { transform: translateY(4px) rotate(3deg); opacity: 1; }
  70% { transform: translateY(-2px) rotate(-1deg); }
  100% { transform: translateY(0) rotate(0deg); }
}

@keyframes stat-slide-in {
  0% { transform: translateX(-20px); opacity: 0; }
  100% { transform: translateX(0); opacity: 1; }
}

@keyframes number-pop {
  0% { transform: scale(1); }
  50% { transform: scale(1.4); color: var(--color-gold); }
  100% { transform: scale(1); }
}

@keyframes sparkle {
  0% { transform: translate(0, 0) scale(1); opacity: 1; }
  100% { transform: translate(var(--sx), var(--sy)) scale(0); opacity: 0; }
}

@keyframes ring-expand {
  0% { transform: scale(0.3); opacity: 0.8; }
  100% { transform: scale(2.5); opacity: 0; }
}

@keyframes xp-glow {
  0%, 100% { box-shadow: 0 0 4px var(--color-accent); }
  50% { box-shadow: 0 0 14px var(--color-accent), 0 0 28px var(--color-accent-dim); }
}

.xp-glow {
  animation: xp-glow 1.5s ease-in-out infinite;
}

@keyframes confetti-piece {
  0% { transform: translateY(-20px) rotate(0deg); opacity: 1; }
  100% { transform: translateY(40px) rotate(360deg); opacity: 0; }
}

@keyframes float-up {
  0% { transform: translateY(0); opacity: 1; }
  100% { transform: translateY(-20px); opacity: 0; }
}

@keyframes gold-shimmer {
  0% { background-position: -200% center; }
  100% { background-position: 200% center; }
}

.gold-shimmer {
  background: linear-gradient(
    90deg,
    var(--color-gold) 0%,
    #fff8c4 40%,
    var(--color-gold) 60%,
    #fff8c4 80%,
    var(--color-gold) 100%
  );
  background-size: 200% auto;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: gold-shimmer 2s linear infinite;
}

@keyframes btn-glow-strong {
  0%, 100% { box-shadow: 0 0 8px var(--color-accent), 0 0 16px var(--color-accent-dim); }
  50% { box-shadow: 0 0 16px var(--color-accent), 0 0 32px var(--color-accent-dim), 0 0 48px var(--color-accent-dim); }
}

.btn-glow-strong {
  animation: btn-glow-strong 1.8s ease-in-out infinite;
}

/* チェック時リップル */
@keyframes check-ripple {
  0% { transform: scale(1); opacity: 0.6; }
  100% { transform: scale(2.2); opacity: 0; }
}

.check-ripple {
  position: relative;
}

.check-ripple::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 3px;
  border: 2px solid var(--ripple-color, var(--color-accent));
  animation: check-ripple 0.4s ease-out forwards;
  pointer-events: none;
}

@keyframes submit-flash {
  0% { opacity: 0.25; }
  100% { opacity: 0; }
}

.submit-flash {
  animation: submit-flash 0.4s ease-out forwards;
}

.float-up-anim {
  animation: float-up 1.2s ease-out forwards;
}

.confetti {
  animation: confetti-piece 1s ease-out forwards;
}

@keyframes fade-in-delayed {
  from { opacity: 0; transform: translateY(4px); }
  to { opacity: 1; transform: translateY(0); }
}

.fade-in-delayed {
  animation: fade-in-delayed 0.4s ease-out forwards;
  animation-delay: 0.8s;
  opacity: 0;
}

/* 覚悟ゲージグロー */
@keyframes gauge-glow {
  0%, 100% { box-shadow: 0 0 4px var(--color-gold), 0 0 8px var(--color-gold-dim); }
  50% { box-shadow: 0 0 8px var(--color-gold), 0 0 16px var(--color-gold-dim), 0 0 24px var(--color-gold-dim); }
}

.gauge-glow {
  animation: gauge-glow 2s ease-in-out infinite;
}

/* RPG ボーダーアニメーション */
@keyframes rpg-border-glow {
  0%, 100% { border-color: var(--color-rpg-border); }
  50% { border-color: var(--color-gold); box-shadow: 0 0 12px var(--color-gold-dim); }
}

.rpg-border-glow {
  animation: rpg-border-glow 2s ease-in-out infinite;
}

/* ピクセルフォント風の数字表示 */
.pixel-num {
  font-variant-numeric: tabular-nums;
  letter-spacing: 0.05em;
}

/* スクロールバー */
::-webkit-scrollbar {
  width: 6px;
}
::-webkit-scrollbar-track {
  background: var(--color-bg-deep);
}
::-webkit-scrollbar-thumb {
  background: var(--color-rpg-border-dim);
  border-radius: 3px;
}
::-webkit-scrollbar-thumb:hover {
  background: var(--color-rpg-border);
}
